module NIST_800_38F::tests::Test_KWP_AE_AES128 where

import NIST_800_38F::AES128 as AES128

// Test Harness
CheckAES128WrapVector : 
    {n} 
    (fin n, 1 <= n, n < 2^^32) 
    => 
    {K:[128], P:[n*8], C:[64 * (1 + n /^ 8)]} -> Bit
CheckAES128WrapVector TV = AES128::KWPAE TV.K TV.P == TV.C

//
// KWP-AE-AES128 Key Wrap Test Vectors
// 

// PLAINTEXT LENGTH = 8, COUNT = 0
TV_00  = {
            K = 0x6decf10a1caf8e3b80c7a4be8c9c84e8,
            P = 0x49,
            C = 0x01a7d657fc4a5b216f261cca4d052c2b
        }

// PLAINTEXT LENGTH = 64, COUNT = 0
TV_01  = {

            K = 0xa8e06da625a65b25cf5030826830b661,
            P = 0x43acff293120dd5d,
            C = 0xb6f967616dd8d772e9fea295a456dba7
        }
// PLAINTEXT LENGTH = 72, COUNT = 0
TV_02  = {

            K = 0x7865e20f3c21659ab4690b629cdf3cc4,
            P = 0xbd6843d420378dc896,
            C = 0x41eca956d4aa047eb5cf4efe659661e74db6f8c564e23500
        }
// PLAINTEXT LENGTH = 248, COUNT = 0
TV_03  = {

            K = 0xbe96dc195ec034d616486ed70e97fe83,
            P = 0x85b5437b6335ebba7635903a4493d12a77d9357a9e0dbc013456d85f1d3201,
            C = 0x974769b3a7b4d5d32985f87fddf9990631e5610fbfb278387b58b1f48e05c77d2fb7575c5169eb0e
        }
TV_04  = {
            //COUNT = 0 : Integer,
            K = 0x0e54956a24c7d4a343f90269fb18a17f,
            P = 0x817ddabdc5d215eee233adff97e92193c6beec52a71340477f70243a794ce954af51e356c9940e4ab198f0e68c543355f65ad179cb2d60dd369eaeb9ed141fb18c9e4054ac7fdc83506896990a4d20833d2d6e9a34938796ee67c9d7d23058544a4a35f2954103ce443a95a7e785602075ca0a73da37899e4568106bb2dbf1f901377d4d3380c70fa5175ebc550481ac6f15986a4407fde5c23ff317e37544c0a25f87117506597db5bb79850c86247b73a5d0090417d63e4c257ea0220c2c04db07a34f0ab7954e1dfa2007a1466795c4d0c2aa09ca3986c028185b43a466526594afc9c891c263a7c608304bc1957c9873f544dc71e6f847c48d32026ed03b2333825452ee7e12a50e1cd7d678319264c65f78001996d37fae7f9861fbd21cb506c2f8a3b0ee53c7debe17111b6e3f78a5c5677857b082c2c4943dfd1edf6337fea98a44fc25928361156ef38d865948b979cf6f4b46bd2119f12f0891cef7fc9d0638fd105fc05f9968d16948d1cb820751e82e44cb68e99d4f072ffd1577da6c0631b5827bec7e1b9ec72d18b74cf5f233e85013c1668ceb5d7a1f5e0f016b0ff726a0a9d41e2cea8e14a2f56492b14606d3fafd8ac141335f39f90d56863735628e8f17be90e100ef0785f3cd57db8b9d89a6b2189dc2ea00c285d2657983f8bd7883c215477e67a55556401f1d8b27d4e0d541c7fb7ace370c2e428884,
            C = 0x876f3e53ba9cf4f6a521ac198bc813d0ede0f862ab6082e3e0a06ad82b4f279582f7c43bb63574608446bc2a05f401a68f74086cf2776b4b3df6b3679c2edfb91c024db54c6831e0752ae6f86c7596462de905ee0be908c1b9d043ecafe2ad1cbddb904e18ebc9b7a107031be3a87059516a3d1257812d9c801b0b9f21539e70c47150c128d87c5e58fa6e4371aedde69c7b5cd16b73ac422676328131f3ac48c602bb6e0741805aad9d23b33b3523b86cf0588cdf9dc6c4d5f9fa43d88ca17976eaf48fb37a41a598266da04144373df5631cc5126341c200a0c8499b29ae96e6e6e6c2bdf8d8903da62bf8ddae970569b695240e77f8ac5b191da5034008b6ef21936858e69bac372bbafd8794f6b03711503c1875528a9348681844edb199a0664d740f0f0b1f866c4248c80fe8b5700a3c4134cdddb17676e0cd37d6d81831a0f4adfba071bb0935502480eccd48b28be5954ea6c7d873b51b8bd2b709c5b6132ed31296510915073c18f7012f0eff6a9aad5340a19fd5e372d35260b718d9e4807b1954c24e6a4fd48e4dbb8f395474e99ab577367d2ab5ccaa18c947331047dc3986e213a878b41089aa221019dad4191a4feefd095f8606c2700a46d71cbb13efb6957df925ec26071c04d04d5a94e138e5fc5d1f059236aad76208077dcc607b1dd2086f9c04e33f955822b457eecd68bd5f24836ecedbac675e6ed93d8a787cb57ad68e
        }


property AES128WrapTest_00 = CheckAES128WrapVector TV_00
property AES128WrapTest_01 = CheckAES128WrapVector TV_01
property AES128WrapTest_02 = CheckAES128WrapVector TV_02
property AES128WrapTest_03 = CheckAES128WrapVector TV_03
property AES128WrapTest_04 = CheckAES128WrapVector TV_04