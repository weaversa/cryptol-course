module NIST_800_38F::tests::Test_KWP_AE_AES256 where

import NIST_800_38F::AES256 as AES256

// Test Harness
CheckAES256WrapVector : 
    {n} 
    (fin n, 1 <= n, n < 2^^32) 
    => 
    {K:[256], P:[n*8], C:[64 * (1 + n /^ 8)]} -> Bit
CheckAES256WrapVector TV = AES256::KWPAE TV.K TV.P == TV.C

//
// KWP-AE-AES256 Key Wrap Test Vectors
// 

// PLAINTEXT LENGTH = 8, COUNT = 0
TV_00  = {
            K = 0x95da2700ca6fd9a52554ee2a8df1386f5b94a1a60ed8a4aef60a8d61ab5f225a,
            P = 0xd1,
            C = 0x06ba7ae6f3248cfdcf267507fa001bc4
        }
TV_01  = {
            K = 0x3517f0efa7f0c4d74f91af83ece5e7503bcc5ab82907a6e4b7ed34d87b69ab1d,
            P = 0x897e0456b289ad31,
            C = 0x0b06a9b635d50cda9d4210cb3a71f990
        }
TV_02  = {
            K = 0x70da43aac823c6dd37d1109f5b18feb4503c973288989745e2cc1cc21d9570c6,
            P = 0xedf17d966ed896aee3,
            C = 0xd67b5b2ad15c645450e23b5e7b6d682f8ae20e716d470db7
        }
TV_03  = {
                K = 0xe9bb7f44c7baafbf392ab912589a2f8db53268106eafb74689bb1833136e6113,
                P = 0xffe952604834bff899e63658f34246815c91597eb40a21729e0a8a959b61f2,
                C = 0x15b9f06fbc765e5e3d55d6b824616f21921d2a6918ee7bf1406b524274e170b4a78333ca5ee92af5
        }
TV_04  = {
                K = 0x20f31cded60b8ed8d9d3fd1e1fa6244e76c7cb7628bfd28a5d63ce8aa2c9494d,
                P = 0xf07225202842c8dede42215301e44b9bb7e625d3812f74f9b6ddbcd024ebd1f33e2cbf280b9004941f3cbf86c880a2357f88f92a6dcf8dad9da7dddcd00f3635efdff0af4382024e93c2af66b991e565eacca6b886f07178c9b4adad6f0d6ada5ff6aa7cd0712519a947a8089cea5e1e3e40ffe1806010b0149f9ffc7c4dd3c31b3d08d5ae1997c52369393d58611dff9bec501c1ab35e6ed3e7f9445a34e211010a8236686f154e0a5ae3433d6a844eb3884961aa6592216d93952b46bb58a4195aa80966ad0ccd4a7e23823912556a90d5ee9c3bb952ecbb9d895dabd3b11ab4f2e3a6c2582de50403289230ef4dc46e7c0d870a3f0cba9d643a0349503c1b162ddb6350e699589eb47bd563999f55a1adb6b78b52f006901b0427ea7d3394bb0adae4637b4f1ad5d5425e2c8ff3083506d7ad7ba4c7405a778b0a3a11760c96900a5256956cc9710091d073a19f46a985d004651fe2b6448ed761bf9bc81619cf273a6783d868d090753bf01318be21afd88d9f3a961a69f93e9d9fb822c80acc7b48cf14a08b5b7ef15c66975721b7cde9761a145b679155472a44dea8fedc0f86ae7ebf6283ecfde5f2444b51569e6723a7a19e28cdf8dec6791ccc14af95abad018f741575b343cb1a20a2a9adf4248f99728069a1e2e78ad8966c41c9918fb7019ef56c153a183a6247d22d9956564bb03075cbfd1b43d96818b28484,
                C = 0xa5b63618fc0c4512960f00a1f226d9837a90480baea75265453b9553b12a58c72153080842d7f8710f317f88fbbbf97caf879ab4bf416ba767ee9aeb34357f4a2d0e8b9571054d98e28804a70bc4d74807f2bfd95ee955bfdbb6f4d6969a0c3c3b541a514647d5cd8c9740ac3496095c3f145c50c97ec98b935158fbdf89705d5330015e48ece89188b8c1bcb2ad6825d865b375a9b9056b743dac720feeac033c9f757f6fe73dd7c4a747661b64cf490a0dd43b547cd791a5d78dac97efcd355f7ebac248fa2a33e4fad640dc34e0d40b0d36588aa32f0864c9446739a6b44ff84666d723bd7d646c5172cda932fec34ddaaba342b02a9604087ef042a2be4774194b5d32cb3fb112438fbf2801050b5424635fa2d3d3fb10332965c73e6669e65195310a3a30602640e9809179cdfc50de585aa1c0072423c626815d281a06eac3b6ffa137716318e288e3f9970e415ef0451bdc557968febf9eb6772c1f77cb8e95701246d9c567048142bb25e340351b87d7391822d9ee7fe51378bc0d08135f9f39cf44b348b87937939dc61f430dfe308cada632722e23aed5a0699e039cf0563ab8025163744b136a13ce3c62c748c89f5e17540f105e7c6ec9ba13515b504342f9e6dc7d65b9a633d8c0b5c9fa858dbb9b3a594406d478a81bb9abfa289730408c1e303c663a61d5caca00f615065312580042862397b9aa8c80ca812887664c439c8c68
        }


property AES256WrapTest_00 = CheckAES256WrapVector TV_00
property AES256WrapTest_01 = CheckAES256WrapVector TV_01
property AES256WrapTest_02 = CheckAES256WrapVector TV_02
property AES256WrapTest_03 = CheckAES256WrapVector TV_03
property AES256WrapTest_04 = CheckAES256WrapVector TV_04